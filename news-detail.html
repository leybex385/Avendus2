<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Detail - Avendus Capital</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="db.js"></script>
    <style>
        body {
            background-color: var(--bg-orange);
            /* Orange background from screenshot */
            margin: 0;
            font-family: 'Outfit', sans-serif;
            color: #333;
        }

        /* Back Button */
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            z-index: 100;
            border: none;
            backdrop-filter: blur(4px);
        }

        .hero-section {
            width: 100%;
            height: 400px;
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.8));
        }

        .hero-content {
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 800px;
            text-align: center;
            /* Centered title based on screenshot layout structure */
            padding-bottom: 60px;
            /* Space for the overlapping card */
        }

        .hero-title {
            color: white;
            font-size: 2rem;
            font-weight: 700;
            margin: 0 1rem 1rem 1rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .hero-meta {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.85rem;
            margin-bottom: 20px;
        }

        .badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 10px;
            border-radius: 4px;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.7rem;
            backdrop-filter: blur(4px);
        }

        /* Content Card */
        .content-card {
            background: white;
            width: 90%;
            max-width: 800px;
            margin: -40px auto 40px auto;
            /* Negative top margin to overlap */
            border-radius: 20px;
            padding: 2rem;
            position: relative;
            z-index: 20;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .author-info {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 2rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
        }

        .author-avatar {
            width: 40px;
            height: 40px;
            background: #1e293b;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-weight: 700;
        }

        .author-text h4 {
            margin: 0;
            font-size: 0.95rem;
            color: #0f172a;
            text-transform: uppercase;
            font-weight: 700;
        }

        .author-text span {
            font-size: 0.8rem;
            color: #64748b;
        }

        .article-body {
            font-size: 1rem;
            line-height: 1.7;
            color: #334155;
        }

        .article-body p {
            margin-bottom: 1.5rem;
        }

        /* Contact/Chat Widget Placeholder from screenshot (optional but nice) */
        .contact-widget {
            position: fixed;
            bottom: 20px;
            right: 0;
            background: #0ea5e9;
            color: white;
            padding: 10px 20px;
            border-radius: 8px 0 0 8px;
            font-weight: 600;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            box-shadow: -2px 2px 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>

    <button class="back-btn" onclick="history.back()"><i data-lucide="chevron-left"></i></button>

    <div class="hero-section" id="heroBg">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <div class="hero-meta">
                <span class="badge">Business</span>
                <span id="heroDate">16 minutes ago</span>
            </div>
            <h1 class="hero-title" id="articleTitle">Loading...</h1>
        </div>
    </div>

    <div class="content-card">
        <div class="author-info">
            <div class="author-avatar" id="authorInitials">TR</div>
            <div class="author-text">
                <h4 id="authorName">Tristan Rich</h4>
                <span id="fullDate">Feb 6, 2026, 09:42 PM</span>
            </div>
        </div>

        <div class="article-body" id="articleContent">
            Loading content...
        </div>
    </div>

    <!-- Modals -->
    <div id="topAlertContainer" class="top-alert-container">
        <div class="top-alert">
            <i data-lucide="alert-circle"></i>
            <span>Please sign in to continue.</span>
            <i data-lucide="x" class="close-alert" onclick="closeAlert()"></i>
        </div>
    </div>

    <div id="messageCenterOverlay" class="message-center-overlay" onclick="toggleMessageCenter()"></div>
    <div id="messageCenter" class="message-center-modal">
        <div class="mc-header">
            <div class="mc-title-row">
                <span class="mc-title">Message Center</span>
                <span class="mc-subtitle" id="msgCount">10 Messages</span>
            </div>
            <button class="mc-close" onclick="toggleMessageCenter()"><i data-lucide="x" size="24"></i></button>
        </div>
        <div class="mc-actions">
            <button class="mc-btn" onclick="makeAllRead()">Make all read</button>
            <button class="mc-btn delete-all" onclick="deleteAllMessages()">Delete all</button>
        </div>
        <div class="mc-list" id="mcList">
            <div class="mc-item">
                <div class="mc-dot unread"></div>
                <div class="mc-content">
                    <div class="mc-msg-title">IPO Announcement – Armour Security IPO（QIB）</div>
                    <div class="mc-time">14-01-2026 15:10:23</div>
                    <div class="mc-tag">IPO:NEW</div>
                    <button class="mc-delete-item" onclick="deleteMessage(this)">Delete</button>
                </div>
            </div>
            <div class="mc-item">
                <div class="mc-dot unread"></div>
                <div class="mc-content">
                    <div class="mc-msg-title">Important Notice</div>
                    <div class="mc-time">12-01-2026 09:32:02</div>
                    <div class="mc-tag">TEXT</div>
                    <button class="mc-delete-item" onclick="deleteMessage(this)">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="settings-modal" onclick="if(event.target == this) closeSettings()">
        <div class="settings-content">
            <button class="settings-close" onclick="closeSettings()"><i data-lucide="x" size="24"></i></button>
            <div class="settings-header">
                <div class="avatar-circle">U</div>
                <div class="settings-name"
                    style="font-size: 1.1rem; font-weight: 700; color: #1e293b; margin-top: 0.5rem;">User Name</div>
                <div class="settings-phone" style="font-size: 0.9rem; color: #64748b; margin-top: 0.2rem;">+91</div>
                <div class="badge-row">
                    <div class="s-badge vip"><i data-lucide="shield-check" size="18"></i> VIP: 0</div>
                    <div class="s-badge credit"><i data-lucide="crown" size="18"></i> Credit Score: 100</div>
                </div>
            </div>
            <div class="settings-list">
                <div class="settings-item" onclick="toggleUserProfile()">
                    <div class="settings-item-icon"><i data-lucide="user" size="20"></i></div>
                    <div class="settings-item-info">
                        <div class="settings-item-title">User Profile</div>
                        <div class="settings-item-desc">Update your profile information.</div>
                    </div>
                    <i data-lucide="chevron-down" id="userProfileChevron" class="settings-chevron" size="18"
                        style="transition: transform 0.2s;"></i>
                </div>
                <div id="userProfileSubmenu" class="settings-submenu">
                    <div class="submenu-item" onclick="openAvatarModal()">
                        <i data-lucide="image" size="18"></i> Update Avatar
                    </div>
                    <div class="submenu-item" onclick="openKYCModal()">
                        <i data-lucide="file-check" size="18"></i> View KYC
                    </div>
                </div>
                <div class="settings-item" onclick="openResetPassword()">
                    <div class="settings-item-icon"><i data-lucide="lock" size="20"></i></div>
                    <div class="settings-item-info">
                        <div class="settings-item-title">Security</div>
                        <div class="settings-item-desc">Update your system security settings.</div>
                    </div>
                    <i data-lucide="chevron-right" class="settings-chevron" size="18"></i>
                </div>
                <div class="settings-item" onclick="window.location.href='bank_accounts.html'">
                    <div class="settings-item-icon"><i data-lucide="landmark" size="20"></i></div>
                    <div class="settings-item-info">
                        <div class="settings-item-title">Bank Accounts</div>
                        <div class="settings-item-desc">Manage bank accounts and info</div>
                    </div>
                    <i data-lucide="chevron-right" class="settings-chevron" size="18"></i>
                </div>
                <div class="settings-item" onclick="openCS()">
                    <div class="settings-item-icon"><i data-lucide="headset" size="20"></i></div>
                    <div class="settings-item-info">
                        <div class="settings-item-title">Customer Service</div>
                        <div class="settings-item-desc">Contact customer service</div>
                    </div>
                    <i data-lucide="chevron-right" class="settings-chevron" size="18"></i>
                </div>
                <div class="settings-item" onclick="alert('Connection Status: Strong (14ms)')">
                    <div class="settings-item-icon"><i data-lucide="search" size="20"></i></div>
                    <div class="settings-item-info">
                        <div class="settings-item-title">Test Connection</div>
                        <div class="settings-item-desc">Test and Diagnosis</div>
                    </div>
                </div>
            </div>
            <div class="logout-btn-container">
                <button class="logout-btn" onclick="DB.logout()">Logout</button>
            </div>
        </div>
    </div>

    <!-- Customer Service Modal -->
    <div id="csModal" class="settings-modal" onclick="if(event.target == this) closeCS()">
        <div class="settings-content" style="max-width: 500px; height: 600px; display: flex; flex-direction: column;">
            <button class="settings-close" onclick="closeCS()"><i data-lucide="x" size="24"></i></button>
            <div class="settings-header" style="margin-bottom: 1rem;">
                <h2 style="font-size: 1.5rem; font-weight: 700;">Customer Service</h2>
            </div>
            <div id="chatBox"
                style="flex: 1; overflow-y: auto; padding: 1rem; background: #f8fafc; border-radius: 12px; margin-bottom: 1rem; display: flex; flex-direction: column; gap: 0.75rem;">
            </div>
            <div style="display: flex; gap: 0.5rem;">
                <input type="text" id="csInput" placeholder="Type a message..."
                    style="flex: 1; padding: 0.8rem; border: 1px solid #e2e8f0; border-radius: 8px; outline: none;">
                <button onclick="sendCSMessage()"
                    style="background: #3b82f6; color: white; border: none; padding: 0 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer;">Send</button>
            </div>
        </div>
    </div>

    <!-- Reset Password Modal (Logged-In) -->
    <div id="resetPasswordModal" class="settings-modal" onclick="if(event.target == this) closeResetPassword()">
        <div class="settings-content" style="max-width: 450px;">
            <button class="settings-close" onclick="closeResetPassword()"><i data-lucide="x" size="24"></i></button>
            <div class="settings-header" style="margin-bottom: 1.5rem;">
                <h2 style="font-size: 1.5rem; font-weight: 700; color: #1e293b;">Reset Password</h2>
            </div>
            <div style="padding: 1rem 0;">
                <div class="reg-input-group" style="margin-bottom: 1.5rem;">
                    <label
                        style="display: block; font-size: 0.9rem; font-weight: 700; color: #1e293b; margin-bottom: 0.5rem;">Current
                        Password</label>
                    <div class="reg-password-wrapper" style="position: relative;">
                        <input type="password" id="currentPass" class="reg-input"
                            style="width: 100%; padding: 0.8rem 1rem; border: 1px solid #e2e8f0; border-radius: 8px; outline: none;">
                        <i data-lucide="eye-off"
                            style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); color: #94a3b8; cursor: pointer;"
                            onclick="toggleInternalPass('currentPass', this)"></i>
                    </div>
                </div>
                <div class="reg-input-group" style="margin-bottom: 1.5rem;">
                    <label
                        style="display: block; font-size: 0.9rem; font-weight: 700; color: #1e293b; margin-bottom: 0.5rem;">New
                        Password</label>
                    <div class="reg-password-wrapper" style="position: relative;">
                        <input type="password" id="newPassInternal" class="reg-input"
                            style="width: 100%; padding: 0.8rem 1rem; border: 1px solid #e2e8f0; border-radius: 8px; outline: none;">
                        <i data-lucide="eye-off"
                            style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); color: #94a3b8; cursor: pointer;"
                            onclick="toggleInternalPass('newPassInternal', this)"></i>
                    </div>
                </div>
                <div class="reg-input-group" style="margin-bottom: 2rem;">
                    <label
                        style="display: block; font-size: 0.9rem; font-weight: 700; color: #1e293b; margin-bottom: 0.5rem;">Confirm
                        New Password</label>
                    <div class="reg-password-wrapper" style="position: relative;">
                        <input type="password" id="confirmPassInternal" class="reg-input"
                            style="width: 100%; padding: 0.8rem 1rem; border: 1px solid #e2e8f0; border-radius: 8px; outline: none;">
                        <i data-lucide="eye-off"
                            style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); color: #94a3b8; cursor: pointer;"
                            onclick="toggleInternalPass('confirmPassInternal', this)"></i>
                    </div>
                </div>
                <button class="logout-btn" style="background: #3b82f6;" onclick="handleInternalReset()">Update
                    Password</button>
                <button class="logout-btn" style="background: #f1f5f9; color: #64748b; margin-top: 1rem;"
                    onclick="closeResetPassword()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Avatar Modal -->
    <div id="avatarModal" class="center-popup-modal">
        <div class="center-popup-content avatar-form" style="max-width: 400px;">
            <div class="popup-header"
                style="width:100%; display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h2 style="font-size: 1.25rem; font-weight: 700;">Update Avatar</h2>
                <button class="popup-close" onclick="closeAvatarModal()"><i data-lucide="x" size="24"></i></button>
            </div>
            <div class="popup-body" style="display:flex; flex-direction:column; align-items:center; width: 100%;">
                <div class="avatar-preview-lg" id="avatarPreviewContainer"
                    onclick="document.getElementById('avatarInput').click()">
                    <i data-lucide="user" size="64" style="color:#cbd5e1;" id="avatarPlaceholderIcon"></i>
                    <img id="avatarPreviewImg" src="" style="display:none;">
                    <div class="avatar-change-overlay">Change Image</div>
                </div>
                <input type="file" id="avatarInput" hidden onchange="previewAvatar(this)" accept="image/*">
                <div style="width: 100%; margin-top: 2rem; display: flex; flex-direction: column; gap: 0.75rem;">
                    <button class="btn-primary" onclick="uploadAvatar()">Save Changes</button>
                    <button class="btn-secondary" onclick="closeAvatarModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- KYC Modal -->
    <div id="kycModal" class="center-popup-modal">
        <div class="center-popup-content">
            <div class="popup-header">
                <h2>View KYC</h2>
                <button class="popup-close" onclick="closeKYCModal()"><i data-lucide="x"></i></button>
            </div>
            <div class="popup-body">
                <div class="kyc-form-grid">
                    <div class="kyc-field-label">Full Name</div>
                    <input type="text" id="kycName" class="kyc-field-input" placeholder="Enter Full Name">
                    <div class="kyc-field-label">Mobile Number</div>
                    <input type="text" id="kycMobile" class="kyc-field-input" readonly style="background: #f8fafc;">
                    <div class="kyc-field-label">ID Number</div>
                    <input type="text" id="kycIdNum" class="kyc-field-input" placeholder="Enter ID Number">
                    <div class="kyc-field-label">Submitted On</div>
                    <input type="text" id="kycSubmitted" class="kyc-field-input" readonly style="background: #f8fafc;">
                    <div class="kyc-field-label">Approval Status</div>
                    <input type="text" id="kycApproved" class="kyc-field-input" readonly style="background: #f8fafc;">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem;">
                    <div class="kyc-upload-box" onclick="document.getElementById('kycFrontInput').click()">
                        <div class="plus-icon">+ Front</div>
                        <img id="kycFrontPreview" style="display:none; width:100%; height:100%; object-fit:cover;">
                        <input type="file" id="kycFrontInput" hidden
                            onchange="previewKYCImage(this, 'kycFrontPreview')">
                    </div>
                    <div class="kyc-upload-box" onclick="document.getElementById('kycBackInput').click()">
                        <div class="plus-icon">+ Back</div>
                        <img id="kycBackPreview" style="display:none; width:100%; height:100%; object-fit:cover;">
                        <input type="file" id="kycBackInput" hidden onchange="previewKYCImage(this, 'kycBackPreview')">
                    </div>
                </div>
                <button class="btn-submit" onclick="submitKYC()" style="margin-top: 1.5rem; width: 100%;">Submit
                    Verification</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Safe decode utility
        function safeDecode(str) {
            try {
                return decodeURIComponent(str);
            } catch (e) {
                return str;
            }
        }

        // Parse URL params
        const params = new URLSearchParams(window.location.search);

        const title = safeDecode(params.get('title') || 'Market Notice');
        const author = safeDecode(params.get('author') || 'Admin');
        const date = safeDecode(params.get('date') || 'Just now');
        const img = safeDecode(params.get('img') || 'https://images.unsplash.com/photo-1611974765270-ca1258634369?auto=format&fit=crop&q=80&w=1200');
        const content = safeDecode(params.get('content') || '');

        // Default content text if no content param provided
        const defaultText = `Guinness Atkinson Asset Management Inc bought a new stake in shares of Trane Technologies plc (NYSE:TT – Free Report) during the 3rd quarter, according to its most recent Form 13F filing with the Securities and Exchange Commission (SEC). The fund bought 2,159 shares of the company's stock, valued at approximately $895,000.<br><br>A number of other hedge funds and other institutional investors also recently made changes to their positions in the business. Icon Advisers Inc. Co. bought a new stake in shares of Trane Technologies during the 2nd quarter valued at about $26,000. Financial Consulate Inc. purchased a new stake in Trane Technologies in the third quarter worth about $25,000.<br><br>Hantz Financial Services Inc. boosted its position in Trane Technologies by 1,016.7% during the 2nd quarter. Hantz Financial Services Inc. now owns 67 shares of the company's stock valued at $29,000 after acquiring an additional 61 shares in the last quarter.<br><br>This strategic move highlights the growing confidence in sustainable infrastructure solutions and the long-term value proposition of the sector. Investors are advised to monitor quarterly reports for further consolidations in this space.`;

        // Render Data
        document.title = title + " - Avendus";
        document.getElementById('articleTitle').textContent = title;
        document.getElementById('authorName').textContent = author;
        document.getElementById('heroDate').textContent = date;
        document.getElementById('fullDate').textContent = date;
        document.getElementById('heroBg').style.backgroundImage = `url('${img}')`;

        // Initials
        const names = author.split(' ');
        let initials = names[0][0];
        if (names.length > 1) initials += names[names.length - 1][0];
        document.getElementById('authorInitials').textContent = initials;

        // Use content from URL or default
        document.getElementById('articleContent').innerHTML = content ? content.replace(/\n/g, '<br><br>') : defaultText;
    </script>
</body>

</html>
